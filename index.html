<!DOCTYPE html>
<html lang="ko">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-43YD0Q3WHW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-43YD0Q3WHW');
</script>
  <meta charset="UTF-8" />
  <title>ì£¼ì‹ë‹¨í…Œ ì†ìµë¹„ ì‹œìŠ¤í…œ ëŒ€ì‹œë³´ë“œ v4</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
        "Noto Sans KR", sans-serif;
    }
    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #020617 0, #020617 45%, #000 100%);
      color: #e5e7eb;
    }
    .dashboard {
      width: 1150px;
      max-width: 96vw;
      padding: 26px 30px 30px;
      border-radius: 20px;
      background: linear-gradient(145deg, #020617, #020617 55%, #020617);
      box-shadow:
        0 32px 80px rgba(0, 0, 0, 0.85),
        0 0 0 1px rgba(148, 163, 184, 0.12);
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 22px;
    }
    .title {
      font-size: 24px;
      font-weight: 700;
      color: #f9fafb;
    }
    .subtitle {
      font-size: 13px;
      color: #9ca3af;
      margin-top: 4px;
    }
    .badge {
      font-size: 11px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(56, 189, 248, 0.14);
      border: 1px solid rgba(56, 189, 248, 0.45);
      color: #7dd3fc;
    }
    .grid {
      display: grid;
      grid-template-columns: 1.1fr 1.1fr 1.4fr;
      gap: 18px;
    }
    .card {
      background: radial-gradient(circle at top left, #020617 0, #020617 55%);
      border-radius: 16px;
      padding: 16px 18px 14px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      box-shadow: 0 14px 40px rgba(15, 23, 42, 0.95);
      margin-top: 0;
    }
    .card h3 {
      font-size: 14px;
      color: #e5e7eb;
      margin-bottom: 4px;
    }
    .card-small {
      font-size: 11px;
      color: #6b7280;
      margin-bottom: 8px;
    }
    .row {
      display: flex;
      gap: 10px;
      margin-top: 6px;
    }
    .row-item {
      flex: 1;
    }
    .label {
      font-size: 11px;
      color: #9ca3af;
      margin-bottom: 3px;
    }
    input[type="number"] {
      width: 100%;
      padding: 5px 7px;
      border-radius: 8px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      background: #020617;
      color: #e5e7eb;
      font-size: 12px;
    }
    .slider-wrapper {
      margin-top: 8px;
    }
    input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      height: 4px;
      border-radius: 999px;
      background: linear-gradient(90deg, #0ea5e9, #22c55e);
      outline: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #f9fafb;
      border: 2px solid #0ea5e9;
      box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.35);
      cursor: pointer;
    }
    .value-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }
    .value-label {
      font-size: 12px;
      color: #9ca3af;
    }
    .value-number {
      font-size: 15px;
      font-weight: 700;
    }
    .highlight {
      font-size: 26px;
      font-weight: 800;
      letter-spacing: 0.02em;
      background: linear-gradient(135deg, #22c55e, #4ade80, #38bdf8);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .highlight-sub {
      font-size: 12px;
      color: #9ca3af;
      margin-top: 4px;
    }
    .tag-row {
      display: flex;
      gap: 6px;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    .tag {
      font-size: 10px;
      padding: 3px 7px;
      border-radius: 999px;
      background: rgba(16, 185, 129, 0.16);
      color: #6ee7b7;
      border: 1px solid rgba(16, 185, 129, 0.45);
    }
    .tag-blue {
      background: rgba(37, 99, 235, 0.22);
      color: #93c5fd;
      border-color: rgba(59, 130, 246, 0.5);
    }
    .chart-wrapper {
      height: 250px;
      margin-top: 10px;
    }
    .footer-note {
      font-size: 10px;
      color: #6b7280;
      margin-top: 10px;
      text-align: right;
    }
    .card + .chart-card {
      margin-top: 18px;
    }
    @media (max-width: 960px) {
      .grid { grid-template-columns: 1fr; }
      .chart-wrapper { height: 220px; }
    }
  </style>
</head>
<body>
<div class="dashboard">
  <div class="header">
    <div>
      <div class="title">ì£¼ì‹ë‹¨í…Œ ì†ìµë¹„ ì‹œìŠ¤í…œ ëŒ€ì‹œë³´ë“œ v4</div>
      <div class="subtitle">
        ì†ì ˆ %, ëª©í‘œ %, ìŠ¹ë¥ , 1íšŒ íˆ¬ìê¸ˆìœ¼ë¡œ ì†ìµ êµ¬ì¡°ë¥¼ ë³´ê³ ,
        ì•„ë˜ì—ì„œ 2ì°¨ ë¶„í• ë§¤ìˆ˜(ì˜ˆ: -15%) ì‹œ í‰ê·  ë§¤ìˆ˜ê°€ì™€ ì†ì ˆÂ·ëª©í‘œê°€ ë³€í™”ë¥¼ í•¨ê»˜ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </div>
    </div>
    <div class="badge">Risk / Reward Â· KRW Â· Simulation</div>
  </div>

  <!-- 1. ë§¨ ìœ„ 3ê°œ ì¹´ë“œ -->
  <div class="grid">
    <!-- ë§¤ë§¤ êµ¬ì¡° ì…ë ¥ -->
    <div class="card">
      <h3>ë§¤ë§¤ êµ¬ì¡° ì…ë ¥</h3>
      <div class="card-small">ë³¸ì¸ì´ ì“°ëŠ” ë‹¨íƒ€Â·ìŠ¤ìœ™Â·ì¤‘ì¥ê¸° ê¸°ì¤€ì„ ê·¸ëŒ€ë¡œ ì…ë ¥í•˜ì„¸ìš”.</div>
      <div class="row">
        <div class="row-item">
          <div class="label">ì†ì ˆ í­ (%)</div>
          <input type="number" id="riskPercent" value="2" step="0.1" />
        </div>
        <div class="row-item">
          <div class="label">ëª©í‘œ í­ (%)</div>
          <input type="number" id="rewardPercent" value="4" step="0.1" />
        </div>
      </div>
      <div class="row" style="margin-top:8px;">
        <div class="row-item">
          <div class="label">ìŠ¹ë¥  (%)</div>
          <input type="number" id="winRateInput" value="50" step="1" />
        </div>
        <div class="row-item">
          <div class="label">1íšŒ ë§¤ë§¤ íˆ¬ìê¸ˆ (â‚©)</div>
          <input type="number" id="capitalPerTrade" value="2000000" step="100000" />
        </div>
      </div>
      <div class="value-row" style="margin-top:10px;">
        <div class="value-label">ì†ìµë¹„ (ëª©í‘œ ìˆ˜ìµ Ã· ì†ì ˆ ì†ì‹¤)</div>
        <div class="value-number" id="rrLabel">2.00 : 1</div>
      </div>
      <div class="value-row">
        <div class="value-label">1íšŒ ì†ì ˆ ì‹œ ì†ì‹¤ê¸ˆì•¡</div>
        <div class="value-number" id="oneLossLabel">â‚©40,000</div>
      </div>
    </div>

    <!-- ê¸°ëŒ€ê°’ ì¹´ë“œ -->
    <div class="card">
      <h3>ê¸°ëŒ€ê°’(Expectancy)</h3>
      <div class="card-small">
        ê¸°ëŒ€ê°’ = ìŠ¹ë¥ Ã—ëª©í‘œ ìˆ˜ìµ âˆ’ (1âˆ’ìŠ¹ë¥ )Ã—ì†ì ˆ ì†ì‹¤ (1íšŒ ë§¤ë§¤ ê¸°ì¤€, ì›í™” ê¸°ì¤€).
      </div>

      <div class="value-row" style="margin-top:6px;">
        <div class="value-label">ìŠ¹ë¥  (Win Rate)</div>
        <div class="value-number" id="winRateLabel">50%</div>
      </div>

      <div style="margin-top:14px;">
        <div class="highlight" id="expectancyMoneyLabel">+â‚©20,000</div>
        <div class="highlight-sub" id="expectancyInfoLabel">
          1íšŒ ë§¤ë§¤ë¥¼ í•  ë•Œ í‰ê· ì ìœ¼ë¡œ ì´ ì •ë„ ê¸ˆì•¡ì´ ê³„ì¢Œì— ë”í•´ì§€ê±°ë‚˜ ë¹ ì ¸ë‚˜ì˜¤ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.
        </div>
      </div>

      <div class="tag-row">
        <div class="tag">ì‚¬ëŒë§ˆë‹¤ ë‹¤ë¥¸ ê¸°ì¤€ ì…ë ¥ ê°€ëŠ¥</div>
        <div class="tag tag-blue">ì†ìµë¹„ ê¸°ë°˜ ì‹œìŠ¤í…œ ê²€ì¦</div>
        <div class="tag">ì›í™” ê¸°ì¤€ ê¸°ëŒ€ìˆ˜ìµ í™•ì¸</div>
      </div>
    </div>

    <!-- NíšŒ ì´ë¡  ì‹œë®¬ -->
    <div class="card">
      <h3>NíšŒ ë§¤ë§¤ ì‹œë®¬ë ˆì´ì…˜(ì´ë¡ ê°’)</h3>
      <div class="card-small">
        ë™ì¼í•œ êµ¬ì¡°ë¡œ NíšŒ ë°˜ë³µ ë§¤ë§¤í–ˆì„ ë•Œì˜ <b>ì´ë¡ ì  í‰ê·  ëˆ„ì  ìˆ˜ìµ</b>ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
      </div>
      <div class="value-row" style="margin-top:6px;">
        <div class="value-label">ë§¤ë§¤ íšŸìˆ˜ (N)</div>
        <div class="value-number" id="tradesCountLabel">50íšŒ</div>
      </div>
      <div class="slider-wrapper">
        <input type="range" id="tradesSlider" min="10" max="200" step="5" value="50" />
      </div>
      <div class="value-row" style="margin-top:12px;">
        <div class="value-label">NíšŒ ëˆ„ì  ê¸°ëŒ€ìˆ˜ìµ (ì´ë¡ )</div>
        <div class="value-number" id="totalExpectancyMoneyLabel">+â‚©1,000,000</div>
      </div>
      <div class="value-row">
        <div class="value-label">1íšŒ ì†ì ˆ ì‹œ ì†ì‹¤ êµ¬ì¡°</div>
        <div class="value-number" id="structInfoLabel">ì†ì ˆ 1ë²ˆë‹¹ âˆ’â‚©40,000</div>
      </div>
    </div>
  </div>

  <!-- 2. 2ì°¨ ë¶„í• ë§¤ìˆ˜ ì¹´ë“œ -->
  <div class="card chart-card" style="margin-top:20px;">
    <h3>2ì°¨ ë¶„í• ë§¤ìˆ˜ êµ¬ì¡° ê³„ì‚° (ì˜ˆ: -15%ì—ì„œ ì¶”ê°€ ë§¤ìˆ˜)</h3>
    <div class="card-small">
      ìµœì´ˆ ë§¤ìˆ˜ê°€ì™€ 1ì°¨Â·2ì°¨ ë¹„ì¤‘, 2ì°¨ ì§„ì… ë ˆë²¨(í•˜ë½ë¥ )ì„ ì…ë ¥í•˜ë©´<br/>
      í‰ê·  ë§¤ìˆ˜ê°€ì™€ ê·¸ ê¸°ì¤€ ì†ì ˆê°€Â·ëª©í‘œê°€ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤. ì†ì ˆ/ëª©í‘œ %ëŠ” ìƒë‹¨ ì…ë ¥ê°’ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
    </div>

    <!-- ìµœì´ˆ ë§¤ìˆ˜ê°€ / ë¹„ì¤‘ -->
    <div class="row" style="margin-top:6px;">
      <div class="row-item">
        <div class="label">ìµœì´ˆ ë§¤ìˆ˜ê°€ (â‚©)</div>
        <input type="number" id="baseEntryPrice" value="50000" step="100" />
      </div>
      <div class="row-item">
        <div class="label">1ì°¨ ë¹„ì¤‘ (%)</div>
        <input type="number" id="firstPortion" value="50" step="5" />
      </div>
      <div class="row-item">
        <div class="label">2ì°¨ ë¹„ì¤‘ (%)</div>
        <input type="number" id="secondPortion" value="50" step="5" />
      </div>
    </div>

    <!-- ìµœì´ˆ ë§¤ìˆ˜ê°€ ë°”ë¡œ ë°‘: 2ì°¨ ì§„ì…ê°€ + í•˜ë½ë¥  ì…ë ¥ -->
    <div class="row" style="margin-top:8px;">
      <div class="row-item">
        <div class="label">2ì°¨ ì§„ì…ê°€ (â‚©)</div>
        <input type="number" id="secondEntryPriceInput" value="42500" step="100" />
      </div>
      <div class="row-item">
        <div class="label">2ì°¨ ì§„ì… ë ˆë²¨ (1ì°¨ ë§¤ìˆ˜ê°€ ëŒ€ë¹„ í•˜ë½ë¥  %)</div>
        <input type="number" id="secondDropPercent" value="15" step="1" />
      </div>
    </div>

    <!-- ìš”ì•½ ê°’ë“¤ -->
    <div class="value-row" style="margin-top:10px;">
      <div class="value-label">2ì°¨ ì§„ì…ê°€</div>
      <div class="value-number" id="secondEntryPriceLabel">â‚©42,500</div>
    </div>
    <div class="value-row">
      <div class="value-label">í‰ê·  ë§¤ìˆ˜ê°€</div>
      <div class="value-number" id="avgEntryPriceLabel">â‚©46,250</div>
    </div>
    <div class="value-row">
      <div class="value-label">í‰ê·  ë§¤ìˆ˜ê°€ ê¸°ì¤€ ì†ì ˆê°€</div>
      <div class="value-number" id="splitStopPriceLabel">â‚©45,325</div>
    </div>
    <div class="value-row">
      <div class="value-label">í‰ê·  ë§¤ìˆ˜ê°€ ê¸°ì¤€ ëª©í‘œê°€</div>
      <div class="value-number" id="splitTargetPriceLabel">â‚©48,100</div>
    </div>
    <div class="footer-note">
      â€» ì´ íˆ¬ìê¸ˆì€ ìƒë‹¨ì˜ 1íšŒ íˆ¬ìê¸ˆ ì…ë ¥ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ í•˜ê³ , ë¹„ì¤‘(%)ì— ë”°ë¼ 1ì°¨/2ì°¨ì— ë‚˜ëˆ  ë“¤ì–´ê°„ë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.
    </div>
  </div>

  <!-- 3. ê·¸ë˜í”„ 2ê°œ -->
  <div class="card chart-card">
    <h3>ì´ë¡ ìƒ ëˆ„ì  ê¸°ëŒ€ìˆ˜ìµ ê³¡ì„ </h3>
    <div class="card-small">
      ê°™ì€ êµ¬ì¡°ë¡œ NíšŒ ë§¤ë§¤í–ˆì„ ë•Œ, ìˆ˜í•™ì ìœ¼ë¡œ í‰ê· ì ìœ¼ë¡œ ê¸°ëŒ€ë˜ëŠ” ëˆ„ì  ìˆ˜ìµ(ì´ë¡ ê°’)ì„ ì›í™” ê¸°ì¤€ìœ¼ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤.
    </div>
    <div class="chart-wrapper">
      <canvas id="eqChart"></canvas>
    </div>
  </div>

  <div class="card chart-card">
    <h3>ì‹¤ì „ ëœë¤ ì‹œë®¬ë ˆì´ì…˜ ê³¡ì„  (ìŠ¹/íŒ¨ ì„ì¸ ì˜ˆì‹œ 1íšŒ)</h3>
    <div class="card-small">
      ë™ì¼í•œ ìŠ¹ë¥ ê³¼ ì†ìµ êµ¬ì¡°ì—ì„œ ìŠ¹Â·íŒ¨ê°€ ëœë¤í•˜ê²Œ ì„ì˜€ë‹¤ê³  ê°€ì •í•˜ê³ ,
      NíšŒ ë§¤ë§¤ ë™ì•ˆ ëˆ„ì  ì†ìµì´ ì–´ë–»ê²Œ ì›€ì§ì¼ ìˆ˜ ìˆëŠ”ì§€ <b>ì˜ˆì‹œ 1ê°œ</b>ë¥¼ ê·¸ë ¤ì¤ë‹ˆë‹¤.
    </div>
    <div class="chart-wrapper">
      <canvas id="eqSimChart"></canvas>
    </div>
    <div class="footer-note">
      â€» ì‹¤ì „ ê³¡ì„ ì€ ë¬´ì‘ìœ„ ì˜ˆì‹œ 1ê°œì´ë©°, ì‹¤ì œ ë§¤ë§¤ì—ì„œëŠ” ì´ë³´ë‹¤ ë” ì¢‹ê±°ë‚˜ ë‚˜ìœ ë‹¤ì–‘í•œ ê²½ìš°ì˜ ìˆ˜ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.
    </div>
  </div>
</div>

<script>
  const riskPercentInput   = document.getElementById('riskPercent');
  const rewardPercentInput = document.getElementById('rewardPercent');
  const winRateInput       = document.getElementById('winRateInput');
  const capitalInput       = document.getElementById('capitalPerTrade');
  const tradesSlider       = document.getElementById('tradesSlider');

  const rrLabel                  = document.getElementById('rrLabel');
  const oneLossLabel             = document.getElementById('oneLossLabel');
  const winRateLabel             = document.getElementById('winRateLabel');
  const expectancyMoneyLabel     = document.getElementById('expectancyMoneyLabel');
  const expectancyInfoLabel      = document.getElementById('expectancyInfoLabel');
  const tradesCountLabel         = document.getElementById('tradesCountLabel');
  const totalExpectancyMoneyLabel= document.getElementById('totalExpectancyMoneyLabel');
  const structInfoLabel          = document.getElementById('structInfoLabel');

  // ë¶„í• ë§¤ìˆ˜ ê´€ë ¨ ìš”ì†Œ
  const baseEntryPriceInput      = document.getElementById('baseEntryPrice');
  const firstPortionInput        = document.getElementById('firstPortion');
  const secondPortionInput       = document.getElementById('secondPortion');
  const secondDropPercentInput   = document.getElementById('secondDropPercent');
  const secondEntryPriceInput    = document.getElementById('secondEntryPriceInput');

  const secondEntryPriceLabel    = document.getElementById('secondEntryPriceLabel');
  const avgEntryPriceLabel       = document.getElementById('avgEntryPriceLabel');
  const splitStopPriceLabel      = document.getElementById('splitStopPriceLabel');
  const splitTargetPriceLabel    = document.getElementById('splitTargetPriceLabel');

  // ì–´ë–¤ ê°’ì„ ë§ˆì§€ë§‰ìœ¼ë¡œ ìˆ˜ì •í–ˆëŠ”ì§€ ì¶”ì  (drop / price)
  let lastEdited = 'drop';

  function formatCurrencySigned(v) {
    const sign = v < 0 ? '-' : '+';
    return sign + 'â‚©' + Math.abs(Math.round(v)).toLocaleString('ko-KR');
  }
  function formatCurrency(v) {
    return 'â‚©' + Math.round(v).toLocaleString('ko-KR');
  }

  // ì´ë¡  ê·¸ë˜í”„
  const ctxEq = document.getElementById('eqChart').getContext('2d');
  const eqChart = new Chart(ctxEq, {
    type: 'line',
    data: { labels: [], datasets: [{
      label: 'ëˆ„ì  ê¸°ëŒ€ìˆ˜ìµ (ì´ë¡ , â‚©)',
      data: [],
      borderColor: 'rgba(34,197,94,1)',
      backgroundColor: 'rgba(34,197,94,0.18)',
      tension: 0.15,
      fill: true,
      borderWidth: 2
    }]},
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { labels: { color: '#9ca3af', font: { size: 11 } } }
      },
      scales: {
        x: {
          ticks: { color: '#9ca3af', font: { size: 11 } },
          grid:  { color: 'rgba(31,41,55,0.7)' }
        },
        y: {
          ticks: {
            color: '#6b7280',
            font: { size: 10 },
            callback: value => value.toLocaleString('ko-KR')
          },
          grid: { color: 'rgba(31,41,55,0.7)' }
        }
      }
    }
  });

  // ì‹¤ì „ ì‹œë®¬ ê·¸ë˜í”„
  const ctxSim = document.getElementById('eqSimChart').getContext('2d');
  const eqSimChart = new Chart(ctxSim, {
    type: 'line',
    data: { labels: [], datasets: [{
      label: 'ëˆ„ì  ì†ìµ (ëœë¤ ì‹œë®¬ë ˆì´ì…˜, â‚©)',
      data: [],
      borderColor: 'rgba(56,189,248,1)',
      backgroundColor: 'rgba(56,189,248,0.18)',
      tension: 0.2,
      fill: true,
      borderWidth: 2
    }]},
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { labels: { color: '#9ca3af', font: { size: 11 } } }
      },
      scales: {
        x: {
          ticks: { color: '#9ca3af', font: { size: 11 } },
          grid:  { color: 'rgba(31,41,55,0.7)' }
        },
        y: {
          ticks: {
            color: '#6b7280',
            font: { size: 10 },
            callback: value => value.toLocaleString('ko-KR')
          },
          grid: { color: 'rgba(31,41,55,0.7)' }
        }
      }
    }
  });

  function updateDashboard() {
    const riskPct   = Math.max(0, Number(riskPercentInput.value));
    const rewardPct = Math.max(0, Number(rewardPercentInput.value));
    const winRate   = Math.min(100, Math.max(0, Number(winRateInput.value))) / 100;
    const capital   = Math.max(0, Number(capitalInput.value));
    const nTrades   = Math.max(1, Number(tradesSlider.value));

    tradesCountLabel.textContent = nTrades + 'íšŒ';
    winRateLabel.textContent     = (winRate * 100).toFixed(0) + '%';

    const lossPerTrade   = (riskPct   / 100) * capital;
    const rewardPerTrade = (rewardPct / 100) * capital;

    oneLossLabel.textContent = formatCurrency(lossPerTrade);
    structInfoLabel.textContent = 'ì†ì ˆ 1ë²ˆë‹¹ ' + formatCurrency(-lossPerTrade);

    let rrText = 'â€“';
    if (lossPerTrade > 0 && rewardPerTrade > 0) {
      const rrValue = rewardPerTrade / lossPerTrade;
      rrText = rrValue.toFixed(2) + ' : 1';
    }
    rrLabel.textContent = rrText;

    const expMoneyPerTrade = winRate * rewardPerTrade - (1 - winRate) * lossPerTrade;
    expectancyMoneyLabel.textContent = formatCurrencySigned(expMoneyPerTrade);
    expectancyInfoLabel.textContent =
      'ì´ êµ¬ì¡°ë¡œ 1ë²ˆ ë§¤ë§¤í•  ë•Œ, í‰ê· ì ìœ¼ë¡œ ' +
      formatCurrencySigned(expMoneyPerTrade) +
      ' ì •ë„ê°€ ê³„ì¢Œì— ë”í•´ì§€ê±°ë‚˜ ë¹ ì ¸ë‚˜ì˜¤ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.';

    const totalExpMoney = expMoneyPerTrade * nTrades;
    totalExpectancyMoneyLabel.textContent = formatCurrencySigned(totalExpMoney);

    // 1) ì´ë¡  ê³¡ì„ 
    const labels = [];
    const dataEq = [];
    for (let i = 1; i <= nTrades; i++) {
      labels.push(i + 'íšŒ');
      dataEq.push(expMoneyPerTrade * i);
    }
    eqChart.data.labels = labels;
    eqChart.data.datasets[0].data = dataEq;
    eqChart.update();

    // 2) ëœë¤ ì‹¤ì „ ì‹œë®¬ë ˆì´ì…˜
    const dataSim = [];
    let equity = 0;
    for (let i = 1; i <= nTrades; i++) {
      const win = Math.random() < winRate;
      equity += win ? rewardPerTrade : -lossPerTrade;
      dataSim.push(equity);
    }
    eqSimChart.data.labels = labels;
    eqSimChart.data.datasets[0].data = dataSim;
    eqSimChart.update();

    // === 2ì°¨ ë¶„í• ë§¤ìˆ˜ ê³„ì‚° ===
    const basePrice   = Math.max(0, Number(baseEntryPriceInput.value));
    const firstPort   = Math.max(0, Number(firstPortionInput.value));
    const secondPort  = Math.max(0, Number(secondPortionInput.value));

    let drop2         = Math.max(0, Number(secondDropPercentInput.value));
    let secondPrice   = Math.max(0, Number(secondEntryPriceInput.value));

    // ë‘ ê°’ ì—°ë™ ë¡œì§
    if (basePrice > 0) {
      if (lastEdited === 'drop') {
        // í•˜ë½ë¥  ê¸°ì¤€ìœ¼ë¡œ 2ì°¨ ì§„ì…ê°€ ê³„ì‚°
        secondPrice = basePrice * (1 - drop2 / 100);
        secondEntryPriceInput.value = Math.round(secondPrice);
      } else if (lastEdited === 'price') {
        // 2ì°¨ ì§„ì…ê°€ ê¸°ì¤€ìœ¼ë¡œ í•˜ë½ë¥  ê³„ì‚°
        if (secondPrice > 0) {
          drop2 = (1 - secondPrice / basePrice) * 100;
          if (drop2 < 0) drop2 = 0;     // ìƒìŠ¹ê°€ëŠ” 0%ë¡œ í´ë¨í”„
          secondDropPercentInput.value = drop2.toFixed(2);
        }
      }
    }

    const weightSum = firstPort + secondPort || 1;
    const avgPrice  = (basePrice * firstPort + secondPrice * secondPort) / weightSum;

    const stopPrice   = avgPrice * (1 - riskPct / 100);
    const targetPrice = avgPrice * (1 + rewardPct / 100);

    secondEntryPriceLabel.textContent = formatCurrency(secondPrice);
    avgEntryPriceLabel.textContent    = formatCurrency(avgPrice);
    splitStopPriceLabel.textContent   = formatCurrency(stopPrice);
    splitTargetPriceLabel.textContent = formatCurrency(targetPrice);
  }

  // ì¼ë°˜ ì…ë ¥ë“¤ì€ ë°”ë¡œ ì—…ë°ì´íŠ¸
  [
    riskPercentInput, rewardPercentInput, winRateInput, capitalInput,
    baseEntryPriceInput, firstPortionInput, secondPortionInput
  ].forEach(el => el.addEventListener('input', updateDashboard));

  // 2ì°¨ ì§„ì… ë ˆë²¨ / 2ì°¨ ì§„ì…ê°€ëŠ” ë§ˆì§€ë§‰ ìˆ˜ì •ê°’ ê¸°ì¤€ìœ¼ë¡œ ì„œë¡œ ì—°ë™
  secondDropPercentInput.addEventListener('input', () => {
    lastEdited = 'drop';
    updateDashboard();
  });
  secondEntryPriceInput.addEventListener('input', () => {
    lastEdited = 'price';
    updateDashboard();
  });

  tradesSlider.addEventListener('input', updateDashboard);

  updateDashboard();
</script>
  <div style="margin: 50px auto; max-width: 800px; background: #ffffff; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.15); border: 1px solid #e1e4e8; font-family: sans-serif;">
    <div style="background: #673ab7; color: white; padding: 18px; text-align: center;">
        <h3 style="margin: 0; font-size: 1.2rem;">ğŸ“¢ ë…ìë‹˜ë“¤ì˜ ì†Œì¤‘í•œ í•œë§ˆë””</h3>
        <p style="margin: 5px 0 0; font-size: 0.85rem; opacity: 0.9;">ë°¥ê·¸ë¦‡ íŒ¨í„´ 1~4ë²ˆ í™œìš© í›„ê¸°ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”!</p>
    </div>
    
   <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSc8kGHzzScI87jQiFWbCfGbIQf7zpwTBFDkZoOJel6U7qcGkw/viewform?embedded=true" width="640" height="645" frameborder="0" marginheight="0" marginwidth="0">ë¡œë“œ ì¤‘â€¦</iframe>    
    <div style="background: #f8f9fa; padding: 10px; text-align: center; font-size: 0.8rem; color: #666; border-top: 1px solid #eee;">
        ì œì¶œí•˜ì‹  ì˜ê²¬ì€ ì €ì 'ë‹¨í…Œ'ì—ê²Œ ì•ˆì „í•˜ê²Œ ì „ë‹¬ë©ë‹ˆë‹¤.
    </div>
</div>
</body>
</html>



